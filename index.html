<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Book Downloader</title>
    <script src="https://unpkg.com/@tailwindcss/browser@4"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body class="bg-gray-50 text-gray-900">
    <div class="container mx-auto p-6">
        <h1 class="text-4xl font-bold text-center mb-8 flex items-center justify-center gap-2 hover:text-sky-700">
            Book Downloader
        </h1>
        <div class="mb-6 flex justify-center gap-4">
            <select id="yearSelect" class="p-2 border border-gray-300 rounded">
                <option value="">Select Year</option>
            </select>
            <select id="classSelect" class="p-2 border border-gray-300 rounded" disabled>
                <option value="">Select Class</option>
            </select>
        </div>
        <div id="book-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 border-t border-gray-300 pt-4">
        </div>
    </div>

    <div id="confirmationModal"
        class="fixed inset-0 flex items-center justify-center bg-slate-900/75 bg-opacity-50 hidden transition-opacity">
        <div class="bg-white p-6 rounded-lg shadow-lg text-center transform scale-90 opacity-0 transition-all">
            <p class="mb-4 text-lg">Are you sure you want to download <span id="modalBookName"
                    class="font-semibold"></span>?</p>
            <div class="flex justify-center space-x-4">
                <button id="confirmDownload"
                    class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded flex items-center gap-2">
                    <i class="fa-solid fa-check"></i>
                    Download
                </button>
                <button id="cancelDownload"
                    class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded flex items-center gap-2">
                    <i class="fa-solid fa-xmark"></i>
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <div class="container mx-auto p-6 text-center mt-8">
        <h2 class="text-lg font-semibold">Credits</h2>
        <p class="text-gray-700">Made by AL Zami Rohan</p>
        <p class="text-gray-700">Books are downloaded from NCTB</p>
    </div>

    <script>
        const booksData = {
            2025: {
                "Class 8": {
                    folder: "NCTB-Book-Downloader/books/2025/Class8/",
                    books: [
                        { name: "Agriculture Education", file: "Agriculture Education (Class 8).pdf" },
                        { name: "Anondopath", file: "Anondopath (Class 8).pdf" },
                        { name: "Bangla Bekaron O Nirmiti", file: "Bangla Bekaron O Nirmiti (Class 8).pdf" },
                        { name: "BGS", file: "BGS (Class 8).pdf" },
                        { name: "Charu o Karukola", file: "Charu o Karukola (Class 8).pdf" },
                        { name: "English For Today", file: "English For Today (Class 8).pdf" },
                        { name: "English Grammar & Composition", file: "English Grammar & Composition (Class 8).pdf" },
                        { name: "Gharostho Biggan", file: "Gharostho Biggan (Class 8).pdf" },
                        { name: "ICT", file: "ICT (Class 8).pdf" },
                        { name: "Islam Sikkha", file: "Islam Sikkha (Class 8).pdf" },
                        { name: "Kormo O Jibonmukhi Sikkha", file: "Kormo O Jibonmukhi Sikkha (Class 8).pdf" },
                        { name: "Math", file: "Math (Class 8).pdf" },
                        { name: "Physical Education & Health", file: "Physical Education & Health (Class 8).pdf" },
                        { name: "Science", file: "Science (Class 8).pdf" },
                        { name: "Shahito Konika", file: "Shahito Konika (Class 8).pdf" },
                        { name: "Shohoj Arbi Path", file: "Shohoj Arbi Path (Class 8).pdf" },
                        { name: "Songit", file: "Songit (Class 8).pdf" },
                        { name: "Songkrito", file: "Songkrito (Class 8).pdf" },
                    ]
                }
            }
        };

        let selectedYear, selectedClass, selectedBook, downloadLink;

        function createDownloadLink(fileUrl) {
            const a = document.createElement("a");
            a.href = fileUrl;
            a.download = fileUrl.split("/").pop();
            a.style.display = "none";
            document.body.appendChild(a);
            alert(fileUrl)
            return a;
        }

        $(document).ready(function () {
            const $yearSelect = $("#yearSelect");
            const $classSelect = $("#classSelect");
            const $bookList = $("#book-list");

            $.each(booksData, function (year) {
                $yearSelect.append(`<option value="${year}">${year}</option>`);
            });

            $yearSelect.on("change", function () {
                selectedYear = $(this).val();
                $classSelect.empty().append('<option value="">Select Class</option>');
                if (selectedYear) {
                    $.each(booksData[selectedYear], function (className) {
                        $classSelect.append(`<option value="${className}">${className}</option>`);
                    });
                    $classSelect.prop("disabled", false);
                } else {
                    $classSelect.prop("disabled", true);
                }
            });

            $classSelect.on("change", function () {
                selectedClass = $(this).val();
                $bookList.empty();
                if (selectedClass && selectedYear) {
                    $.each(booksData[selectedYear][selectedClass].books, function (index, book) {
                        const listItem = $(`
                            <li class="flex items-center justify-between bg-white p-4 rounded-lg border border-gray-300 cursor-pointer download-link w-full transition-all hover:bg-gray-100 mb-2" 
                                data-year="${selectedYear}" 
                                data-class="${selectedClass}" 
                                data-book="${book.name}" 
                                data-file="${book.file}">
                                <span class="flex items-center gap-2">
                                    <i class="fa-solid fa-book"></i>
                                    ${book.name}
                                </span>
                                <i class="fa-solid fa-download text-indigo-500"></i>
                            </li>
                        `);
                        $bookList.append(listItem);
                    });
                }
            });

            $(document).on("click", ".download-link", function () {
                selectedBook = $(this).data("book");
                const fileName = $(this).data("file");
                const fileUrl = booksData[selectedYear][selectedClass].folder + fileName;

                $("#modalBookName").text(selectedBook);
                $("#confirmationModal").removeClass("hidden").addClass("flex");
                $("#confirmationModal div").removeClass("scale-90 opacity-0").addClass("scale-100 opacity-100");

                downloadLink = createDownloadLink(fileUrl);
            });

            $("#cancelDownload").on("click", function () {
                $("#confirmationModal div").removeClass("scale-100 opacity-100").addClass("scale-90 opacity-0");
                setTimeout(() => $("#confirmationModal").addClass("hidden").removeClass("flex"), 200);
            });

            $("#confirmDownload").on("click", function () {
                $("#confirmationModal").addClass("hidden");
                downloadLink.click();
            });
        });
    </script>
</body>

</html>